configfile: "config.yaml"

sample=config["samples"]

rule all:
	input:
		expand("/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/{sample}_raw.txt", sample=config["samples"]),
		expand("/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/{sample}_trimmed.txt", sample=config["samples"]),
		expand("/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/{sample}_unmapped.txt", sample=config["samples"]),
		expand("/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/{sample}_humanContaminant.txt", sample=config["samples"]),
		expand("/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/{sample}_noRepeats.txt", sample=config["samples"])

rule rawReads:
	input:
		"/scratch/punim0586/kat/data/raw_data_copied/{sample}_1.fastq.gz"
	output:
		"/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/{sample}_raw.txt"
	shell:
		"echo {wildcards.sample} rawReads `expr $(zcat {input} |wc -l)/4|bc` > {output}"

rule trimmedReads:
	input:
		"/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/{sample}_1.fastq.gz"
	output:
		"/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/{sample}_trimmed.txt"
	shell:
		"echo {wildcards.sample} trimmedReads `expr $(zcat {input} |wc -l)/4|bc` > {output}"

rule unmappedReads:
	input:
		"/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/2mapped/{sample}_Unmapped.out.mate1"
	output:
		"/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/{sample}_unmapped.txt"
	shell:
		"echo {wildcards.sample} unmappedReads `expr $(cat {input} |wc -l)/4|bc` > {output}"

rule humanContaminantReads:
	input:
		"/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/KneadData/{sample}_1_kneaddata_paired_Homo_sapiens_assembly19.fasta_bmtagger_contam_1.fastq"
	output:
		"/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/nuBMRef/{sample}_humanContaminant.txt"
	shell:
		"echo {wildcards.sample} HumanContaminantReads `expr $(cat {input} |wc -l)/4|bc` > {output}"

rule noRepeats:
	input:
		"/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/KneadData/{sample}_1_kneaddata.repeats.removed.1.fastq"
	output:
		"/scratch/punim0586/fachrulm/101BPIndonesianSamplesTrimmed/QC/ReadSummary/nuBMRef/{sample}_noRepeats.txt"
	shell:
		"echo {wildcards.sample} noRepeats `expr $(cat {input} |wc -l)/4|bc` > {output}"

